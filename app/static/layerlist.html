<!doctype html>
<html lang="en" ng-app="Dashboard">
<head>
	<meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<title>WindyDay App</title>
	<link href="static/wind_icon.jpg" rel="icon" type="image/x-icon" />
  
  <link rel="stylesheet" type="text/css" href="static/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="static/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="static/css/dashboard/dashboard.css">
  <link rel="stylesheet" type="text/css" href="static/css/themes/blue.css">
  <!-- LEAFLET AND MAPBOX -->
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
  <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
  <script src='https://api.tiles.mapbox.com/mapbox.js/v2.0.1/mapbox.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox.js/v2.0.1/mapbox.css' rel='stylesheet' />
  
  <!--
  <link rel="stylesheet" type="text/css" href="static/css/themes/green.css">
  <link rel="stylesheet" type="text/css" href="static/css/themes/red.css">
  -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script type="text/javascript" src="static/js/angular.min.js"></script>
  <script type="text/javascript" src="static/js/angular-cookies.js"></script>
  <script type="text/javascript" src="static/js/ng-bootstrap-tpls.min.js"></script>
  <script type="text/javascript" src="static/js/angular/bootstrap.js"></script>
  
  <script type="text/javascript" src="static/js/form2js.js"></script>

</head>
<body ng-controller="MasterCtrl">
  <div id="page-wrapper" ng-class="{'active': toggle}" ng-cloak>

    <!-- Sidebar -->

    <div id="sidebar-wrapper">
      <ul class="sidebar">
        <li class="sidebar-main">
          <a href="#" ng-click="toggleSidebar()">
            WindyDay
            <span class="menu-icon glyphicon glyphicon-transfer"></span>
          </a>
        </li>
        <li class="sidebar-title"><span>NAVIGATION</span></li>
        <li class="sidebar-list">
          <a href="/windyday">WindyDay <span class="menu-icon fa fa-tachometer"></span></a>
        </li>
        <li class="sidebar-list">
          <a href="/cranepath">CranePath <span class="menu-icon fa fa-image"></span></a>
        </li>
        <li class="sidebar-title separator"><span>QUICK LINKS</span></li>
        <li class="sidebar-list">
          <a href="http://huevosabio.com/" target="_blank">Blog <span class="menu-icon fa fa-external-link"></span></a>
        </li>
      </ul>
      <div class="sidebar-footer">
        <div class="col-xs-4">
          <a href="https://github.com/huevosabio/windDayApp" target="_blank">
            Github
          </a>
        </div>
        <div class="col-xs-4">
          <a href="#" target="_blank">
            About
          </a>
        </div>
        <div class="col-xs-4">
          <a href="#">
            Support
          </a>
        </div>
      </div>
    </div>

    <!-- End Sidebar -->

    <div id="content-wrapper">
      <div class="page-content">

        <!-- Header Bar -->

        <div class="row header">
          <div class="col-xs-12">
            <div class="meta pull-left">
              <div class="page">
                WindyDay
              </div>
              <div class="breadcrumb-links">
                Home / WindyDay
              </div>
            </div>
            <div class="user pull-right">
              <div class="item dropdown">
                <a href="#" class="dropdown-toggle">
                  <img src="static/img/avatar.jpg">
                </a>
                <ul class="dropdown-menu dropdown-menu-right">
                  <li class="dropdown-header">
                    Joe Bloggs
                  </li>
                  <li class="divider"></li>
                  <li class="link">
                    <a href="#">
                      Profile
                    </a>
                  </li>
                  <li class="link">
                    <a href="#">
                      Menu Item
                    </a>
                  </li>
                  <li class="link">
                    <a href="#">
                      Menu Item
                    </a>
                  </li>
                  <li class="divider"></li>
                  <li class="link">
                    <a href="#">
                      Logout
                    </a>
                  </li>
                </ul>               
              </div>
              <div class="item dropdown">
               <a href="#" class="dropdown-toggle">
                  <i class="fa fa-bell-o"></i>
                </a>
                <ul class="dropdown-menu dropdown-menu-right">
                  <li class="dropdown-header">
                    Notifications
                  </li>
                  <li class="divider"></li>
                  <li>
                    <a href="#">Server Down!</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <!-- End Header Bar -->

        <!-- Main Content -->
      <div class="row">
        <div class="col-lg-6">
          <div class="widget">
            <div class="widget-title">
               <i class="fa fa-image"></i> Layer Information<button type="submit" id="tspopt" class="btn btn-default pull-right">Create Sequence</button>
            </div>
            <div class="widget-body no-padding">
                <div class="form-group">
                    <form id="daform" enctype="multipart/form-data">
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Layer Name</th>
                                        <th>Interpretation</th>
                                        <th>Associated Cost [USD]</th>
                                    </tr>
                                </thead>
                                <tbody id="formbody">
                                </tbody>
                            </table>
                        </div>
                  </form>
              </div>
            </div>
            </div>
          </div>
        </div>

        <!-- End Main Content -->

      </div><!-- End Page Content -->
    </div><!-- End Content Wrapper -->
  </div><!-- End Page Wrapper -->
<script>
    $.getJSON( "/cranepath/layerlist", function( data ) {
        $.each(data.layers, function(index,layer){
            var select = '<select class="selectpicker" name = "'+layer+'.interpretation" form="daform"><option value="crossing">Crossing</option><option value="turbines">Turbines</option><option value="boundary">Boundary</option></select>';
            var cost = '<input class="form-control" type="decimal" name="'+layer+'.cost" onkeypress="return isDecimalKey(event)" onkeypress="return isDecimalKey(event)" placeholder="Associated Cost in USD" value="0.0"/>';
            $('#formbody').append("<tr><td>"+layer+"</td><td>"+select+"</td><td>"+cost+"</td></tr>");
        });
    });
    
    function isDecimalKey(evt){
          var charCode = (evt.which) ? evt.which : event.keyCode;
          if (charCode > 31 && (charCode != 46 &&(charCode < 48 || charCode > 57)))
              return false;
          return true;
    }
  </script>
<script>
      $('#tspopt').click(function(){
          
          var formData = form2js('daform','.',true);
          console.log(formData);
          $.ajax({
              url: 'cranepath/tsp',  //Server script to process data
              type: 'POST',
              contentType: 'application/json',
              data: JSON.stringify(formData),
              dataType: 'json',
              success: function (e) {window.location.replace('/solution')}
          });
      });
</script>
<script>
  function validLayers(layers){
  }
</script>
</body>


</html>